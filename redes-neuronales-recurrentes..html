<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Redes Neuronales recurrentes. | Análisis de Series de Tiempo relacionados con COVID19</title>
  <meta name="description" content="Se incluye un análisis de series de tiempo con datos relacionados con el COVID 19 desde 2020 hasta enero de 2024" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Redes Neuronales recurrentes. | Análisis de Series de Tiempo relacionados con COVID19" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Se incluye un análisis de series de tiempo con datos relacionados con el COVID 19 desde 2020 hasta enero de 2024" />
  <meta name="github-repo" content="Familia GSMSciencede tiempo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Redes Neuronales recurrentes. | Análisis de Series de Tiempo relacionados con COVID19" />
  
  <meta name="twitter:description" content="Se incluye un análisis de series de tiempo con datos relacionados con el COVID 19 desde 2020 hasta enero de 2024" />
  

<meta name="author" content="GRUPO 6: Maria José Reina Torres, Sonia Yurany Gallego Paz, Juan José León Tabares" />


<meta name="date" content="2024-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelización.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción:</a></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>2</b> Análisis Exploratorio de datos:</a>
<ul>
<li class="chapter" data-level="2.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#exploración-y-preprocesamiento-del-dataset"><i class="fa fa-check"></i><b>2.1</b> Exploración y preprocesamiento del dataset:</a></li>
<li class="chapter" data-level="2.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#estructura-y-exploración-de-datos-en-serie-de-tiempo"><i class="fa fa-check"></i><b>2.2</b> Estructura y exploración de datos en serie de tiempo:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descomposición-de-la-serie-de-tiempo..html"><a href="descomposición-de-la-serie-de-tiempo..html"><i class="fa fa-check"></i><b>3</b> Descomposición de la serie de tiempo.</a></li>
<li class="chapter" data-level="4" data-path="modelización.html"><a href="modelización.html"><i class="fa fa-check"></i><b>4</b> Modelización</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelización.html"><a href="modelización.html#método-de-holt-winter"><i class="fa fa-check"></i><b>4.1</b> Método de Holt-Winter:</a></li>
<li class="chapter" data-level="4.2" data-path="modelización.html"><a href="modelización.html#método-de-suavizamiento-exponencial"><i class="fa fa-check"></i><b>4.2</b> Método de Suavizamiento Exponencial:</a></li>
<li class="chapter" data-level="4.3" data-path="modelización.html"><a href="modelización.html#modelos-estacionarios-en-series-de-tiempo-metodología-box-jenkins"><i class="fa fa-check"></i><b>4.3</b> Modelos estacionarios en series de tiempo: Metodología Box-Jenkins</a></li>
<li class="chapter" data-level="4.4" data-path="modelización.html"><a href="modelización.html#algoritmo-facebooks-prophet"><i class="fa fa-check"></i><b>4.4</b> Algoritmo Facebook´s Prophet</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="redes-neuronales-recurrentes..html"><a href="redes-neuronales-recurrentes..html"><i class="fa fa-check"></i><b>5</b> Redes Neuronales recurrentes.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="redes-neuronales-recurrentes..html"><a href="redes-neuronales-recurrentes..html#modelo-de-elman"><i class="fa fa-check"></i><b>5.1</b> Modelo de Elman</a></li>
<li class="chapter" data-level="5.2" data-path="redes-neuronales-recurrentes..html"><a href="redes-neuronales-recurrentes..html#modelo-de-jordan."><i class="fa fa-check"></i><b>5.2</b> Modelo de Jordan.</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de Series de Tiempo relacionados con COVID19</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="redes-neuronales-recurrentes." class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Redes Neuronales recurrentes.<a href="redes-neuronales-recurrentes..html#redes-neuronales-recurrentes." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La idea de las redes neuronales recurrentes (RNN) es hacer uso de información secuencial. Esto es, para procesar datos en los cuales hay una dependencia de los datos procesados anteriormente. Debido a la naturaleza de las series de tiempo, la RNN son una herramienta muy apropiada para modelarlas, ya que son un tipo de redes con una arquitectura que implementa una cierta memoria y, por lo tanto, un sentido temporal. Esto se consigue implementando algunas neuronas que reciben como entrada la salida de una de las capas e inyectan su salida en una de las capas de un nivel anterior a ella.</p>
<p>Se cuenta con las redes de ELMAN y JORDAN, las entradas de estas neuronas, se toman desde las salidas de las neuronas de una de las capas ocultas, y sus salidas se conectan de nuevo en las entradas de esta misma capa, lo que proporciona una especie de memoria sobre el estado anterior de dicha capa.</p>
<p>Una red neuronal recurrente no tiene una estructura de capas definida, sino que permiten conexiones arbitrarias entre las neuronas, incluso pudiendo crear ciclos, con esto se consigue crear la temporalidad, permitiendo que la red tenga memoria. Se denominan recurrentes porque realizan la misma tarea para cada elemento de una secuencia, y la salida depende de los cálculos anteriores.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="redes-neuronales-recurrentes..html#cb102-1" tabindex="-1"></a><span class="co">#Se cargan las librerías necesarias para ejecutar las RNN</span></span>
<span id="cb102-2"><a href="redes-neuronales-recurrentes..html#cb102-2" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span>
<span id="cb102-3"><a href="redes-neuronales-recurrentes..html#cb102-3" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<div id="modelo-de-elman" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Modelo de Elman<a href="redes-neuronales-recurrentes..html#modelo-de-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Es un tipo específico de RNN que fue desarrollado por Jeffrey Elman en 1990. Es conocido por su arquitectura de red simple pero efectiva que introduce una capa de contexto para capturar y almacenar información sobre estados previos, lo que le permite aprender dependencias temporales en secuencias de datos.</p>
<p>Consta de las siguientes componentes:</p>
<ul>
<li><p><strong>Capa de Entrada:</strong> Recibe los datos de entrada.</p></li>
<li><p><strong>Capa Oculta:</strong> Procesa los datos de entrada y también recibe la salida de la capa de contexto.</p></li>
<li><p><strong>Capa de Salida:</strong> Produce la predicción o salida final.</p></li>
<li><p><strong>Capa de Contexto:</strong> Almacena una copia de la salida de la capa oculta en el tiempo t-1 y la alimenta de nuevo a la capa oculta en el tiempo t. Esto permite a la red “recordar” información sobre los estados previos y capturar dependencias temporales.</p></li>
</ul>
<p><strong>Ejecución del modelo:</strong></p>
<p>Para ejecutar este modelo se utilizará la transformación logística, esta es una forma de normalización que puede ayudar a manejar mejor los valores extremos y a garantizar que los datos estén en un rango específico, previamente se ejecutaron los modelos con los datos crudos, con una diferenciación y con dos diferenciaciones sin lograr ajuste. Con la transformación logarítmica sí se logró:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="redes-neuronales-recurrentes..html#cb103-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">log</span>(indice_casos.ts))</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<p>En este caso, se evidencia que contamos con 51 datos de casos nuevos de COVID, para aplicar redes neuronales debemos normalizar datos y para ello hemos asociado a nuestro dataset de base una variable “Z” y a partir de esta hemos realizar la normalización a través de la variable “S”.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="redes-neuronales-recurrentes..html#cb105-1" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">log</span>(indice_casos.ts)</span>
<span id="cb105-2"><a href="redes-neuronales-recurrentes..html#cb105-2" tabindex="-1"></a>Z</span></code></pre></div>
<pre><code>##            Jan       Feb       Mar       Apr       May       Jun       Jul
## 2020  9.004545 12.630337 14.836152 15.969380 16.368065 16.578808 17.011414
## 2021 18.347095 17.659231 17.827182 18.224481 18.392062 17.594653 17.821792
## 2022 19.836313 19.376156 19.113990 18.597660 18.214606 17.998059 18.783804
## 2023 19.075335 16.829904 16.552600 16.535733 15.888972 15.172339 15.348595
## 2024 14.818648 14.151991 14.153216                                        
##            Aug       Sep       Oct       Nov       Dec
## 2020 17.441686 17.326382 17.582136 18.251031 18.098591
## 2021 18.328071 17.963014 17.957092 17.970225 18.258388
## 2022 18.371876 17.905457 18.023692 17.621661 19.421381
## 2023 15.666783 15.135003 15.052813 15.048553 15.771688
## 2024</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="redes-neuronales-recurrentes..html#cb107-1" tabindex="-1"></a>S <span class="ot">&lt;-</span> (Z<span class="sc">-</span><span class="fu">min</span>(Z))<span class="sc">/</span>(<span class="fu">max</span>(Z)<span class="sc">-</span><span class="fu">min</span>(Z))  </span>
<span id="cb107-2"><a href="redes-neuronales-recurrentes..html#cb107-2" tabindex="-1"></a>S</span></code></pre></div>
<pre><code>##            Jan       Feb       Mar       Apr       May       Jun       Jul
## 2020 0.0000000 0.3347368 0.5383799 0.6430008 0.6798077 0.6992638 0.7392024
## 2021 0.8625138 0.7990095 0.8145149 0.8511940 0.8666653 0.7930476 0.8140173
## 2022 1.0000000 0.9575179 0.9333144 0.8856463 0.8502823 0.8302905 0.9028312
## 2023 0.9297457 0.7224452 0.6968443 0.6952871 0.6355773 0.5694170 0.5856893
## 2024 0.5367640 0.4752175 0.4753306                                        
##            Aug       Sep       Oct       Nov       Dec
## 2020 0.7789255 0.7682806 0.7918920 0.8536451 0.8395717
## 2021 0.8607575 0.8270551 0.8265084 0.8277208 0.8543243
## 2022 0.8648017 0.8217413 0.8326569 0.7955410 0.9616930
## 2023 0.6150647 0.5659701 0.5583823 0.5579890 0.6247496
## 2024</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="redes-neuronales-recurrentes..html#cb109-1" tabindex="-1"></a><span class="fu">plot</span>(S)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>A continuación verificamos cuántas filas en total tiene nuestro conjunto de datos.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="redes-neuronales-recurrentes..html#cb110-1" tabindex="-1"></a>tamano_total <span class="ot">&lt;-</span> <span class="fu">length</span>(S)</span>
<span id="cb110-2"><a href="redes-neuronales-recurrentes..html#cb110-2" tabindex="-1"></a>tamano_total</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<p>Ahora dividiremos los conjuntos de entrenamiento en un 75% y prueba en un 25% respectivamente.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="redes-neuronales-recurrentes..html#cb112-1" tabindex="-1"></a>tamano_train <span class="ot">&lt;-</span> <span class="fu">round</span>(tamano_total<span class="sc">*</span><span class="fl">0.75</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb112-2"><a href="redes-neuronales-recurrentes..html#cb112-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(tamano_train<span class="dv">-1</span>)</span>
<span id="cb112-3"><a href="redes-neuronales-recurrentes..html#cb112-3" tabindex="-1"></a>train</span></code></pre></div>
<pre><code>##  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
## [26] 25 26 27 28 29 30 31 32 33 34 35 36 37</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="redes-neuronales-recurrentes..html#cb114-1" tabindex="-1"></a>test <span class="ot">&lt;-</span> (tamano_train)<span class="sc">:</span>tamano_total</span>
<span id="cb114-2"><a href="redes-neuronales-recurrentes..html#cb114-2" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>##  [1] 38 39 40 41 42 43 44 45 46 47 48 49 50 51</code></pre>
<p>Ahora vamos a generar un conjunto de datos con n columnas, donde cada una de ellas representará un valor futuro de la serie, utilizando una variable tipo zoo que refleje el período de desfase de la serie.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="redes-neuronales-recurrentes..html#cb116-1" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb116-2"><a href="redes-neuronales-recurrentes..html#cb116-2" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb116-3"><a href="redes-neuronales-recurrentes..html#cb116-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.zoo</span>(S)</span>
<span id="cb116-4"><a href="redes-neuronales-recurrentes..html#cb116-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb116-5"><a href="redes-neuronales-recurrentes..html#cb116-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb116-6"><a href="redes-neuronales-recurrentes..html#cb116-6" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb116-7"><a href="redes-neuronales-recurrentes..html#cb116-7" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb116-8"><a href="redes-neuronales-recurrentes..html#cb116-8" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb116-9"><a href="redes-neuronales-recurrentes..html#cb116-9" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb116-10"><a href="redes-neuronales-recurrentes..html#cb116-10" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">7</span>)</span>
<span id="cb116-11"><a href="redes-neuronales-recurrentes..html#cb116-11" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb116-12"><a href="redes-neuronales-recurrentes..html#cb116-12" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">9</span>)</span>
<span id="cb116-13"><a href="redes-neuronales-recurrentes..html#cb116-13" tabindex="-1"></a>x10 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb116-14"><a href="redes-neuronales-recurrentes..html#cb116-14" tabindex="-1"></a>x11 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">11</span>)</span>
<span id="cb116-15"><a href="redes-neuronales-recurrentes..html#cb116-15" tabindex="-1"></a>x12 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">12</span>)</span>
<span id="cb116-16"><a href="redes-neuronales-recurrentes..html#cb116-16" tabindex="-1"></a>slogN <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12)</span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="redes-neuronales-recurrentes..html#cb117-1" tabindex="-1"></a><span class="fu">library</span>(DT)</span></code></pre></div>
<pre><code>## Warning: package &#39;DT&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="redes-neuronales-recurrentes..html#cb119-1" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(slogN)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ab9ed8872c0c652d5d40" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab9ed8872c0c652d5d40">{"x":{"filter":"none","vertical":false,"data":[[0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637,0.4752175347693749,0.47533055785621],[null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637,0.4752175347693749],[null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637],[null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293],[null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648],[null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792],[null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037],[null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615],[null,null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006],[null,null,null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894],[null,null,null,null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846],[null,null,null,null,null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407],[null,null,null,null,null,null,null,null,null,null,null,null,0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>y<\/th>\n      <th>Lag.1<\/th>\n      <th>Lag.2<\/th>\n      <th>Lag.3<\/th>\n      <th>Lag.4<\/th>\n      <th>Lag.5<\/th>\n      <th>Lag.6<\/th>\n      <th>Lag.7<\/th>\n      <th>Lag.8<\/th>\n      <th>Lag.9<\/th>\n      <th>Lag.10<\/th>\n      <th>Lag.11<\/th>\n      <th>Lag.12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12]},{"name":"y","targets":0},{"name":"Lag.1","targets":1},{"name":"Lag.2","targets":2},{"name":"Lag.3","targets":3},{"name":"Lag.4","targets":4},{"name":"Lag.5","targets":5},{"name":"Lag.6","targets":6},{"name":"Lag.7","targets":7},{"name":"Lag.8","targets":8},{"name":"Lag.9","targets":9},{"name":"Lag.10","targets":10},{"name":"Lag.11","targets":11},{"name":"Lag.12","targets":12}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>A continuación, procederemos a eliminar los valores NA que se generaron al desplazar la serie.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="redes-neuronales-recurrentes..html#cb120-1" tabindex="-1"></a>slogN1 <span class="ot">&lt;-</span> slogN[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>),]</span>
<span id="cb120-2"><a href="redes-neuronales-recurrentes..html#cb120-2" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(slogN1)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4ffc0215f0217367a2c3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4ffc0215f0217367a2c3">{"x":{"filter":"none","vertical":false,"data":[[0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637,0.4752175347693749,0.47533055785621],[0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637,0.4752175347693749],[0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293,0.536764010276637],[0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648,0.6247495619491293],[0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792,0.557988998530648],[0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037,0.5583823122813792],[0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615,0.5659701406392037],[0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006,0.6150647074897615],[0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894,0.5856892546314006],[0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846,0.5694170400682894],[0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407,0.6355773389997846],[0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379,0.695287058270407],[0,0.3347367924203117,0.5383799468138767,0.6430007630950018,0.6798077423790606,0.6992637935727037,0.7392024119369762,0.7789255089914442,0.7682805870805473,0.7918920467818609,0.8536451393089158,0.8395716684397194,0.8625138260146593,0.7990095321033618,0.8145149396022623,0.851193967888444,0.8666652665440934,0.7930476015883999,0.8140173105816551,0.8607575004450416,0.8270550849019135,0.8265083789525116,0.8277207929370365,0.8543243110789771,1,0.9575178601760121,0.9333143965280795,0.8856462742875844,0.850282303042824,0.8302904861885826,0.9028312381267165,0.8648016761661805,0.8217413364060093,0.8326569448070629,0.7955410420659613,0.9616930339228846,0.9297457111010783,0.7224452442464531,0.6968442516434379]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>y<\/th>\n      <th>Lag.1<\/th>\n      <th>Lag.2<\/th>\n      <th>Lag.3<\/th>\n      <th>Lag.4<\/th>\n      <th>Lag.5<\/th>\n      <th>Lag.6<\/th>\n      <th>Lag.7<\/th>\n      <th>Lag.8<\/th>\n      <th>Lag.9<\/th>\n      <th>Lag.10<\/th>\n      <th>Lag.11<\/th>\n      <th>Lag.12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12]},{"name":"y","targets":0},{"name":"Lag.1","targets":1},{"name":"Lag.2","targets":2},{"name":"Lag.3","targets":3},{"name":"Lag.4","targets":4},{"name":"Lag.5","targets":5},{"name":"Lag.6","targets":6},{"name":"Lag.7","targets":7},{"name":"Lag.8","targets":8},{"name":"Lag.9","targets":9},{"name":"Lag.10","targets":10},{"name":"Lag.11","targets":11},{"name":"Lag.12","targets":12}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Luego definimos los valores de entrada y salida de la red neuronal:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="redes-neuronales-recurrentes..html#cb121-1" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> slogN1[,<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb121-2"><a href="redes-neuronales-recurrentes..html#cb121-2" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> slogN1[,<span class="dv">1</span>]</span></code></pre></div>
<p>Ahora se desarrolla la red de Elman experimentando con diversas configuraciones de neuronas en las capas ocultas, variando también el número máximo de iteraciones y la tasa de aprendizaje. El objetivo es afinar la curva de predicción para que se ajuste lo más cercanamente posible al modelo de la serie. Estos son los parámetros que hemos seleccionado para construir nuestra red. Además, establecemos una semilla para garantizar la reproducibilidad de los resultados.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="redes-neuronales-recurrentes..html#cb122-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb122-2"><a href="redes-neuronales-recurrentes..html#cb122-2" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">elman</span>(inputs[train],outputs[train],<span class="at">size=</span><span class="dv">3</span>,<span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb122-3"><a href="redes-neuronales-recurrentes..html#cb122-3" tabindex="-1"></a>                  <span class="at">maxit=</span><span class="dv">10000</span>)</span></code></pre></div>
<p>En la gráfica siguiente se observa cómo evoluciona el error de la red con el número de iteraciones para los parámetros expuestos.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="redes-neuronales-recurrentes..html#cb123-1" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit, <span class="at">main =</span> <span class="st">&quot;Error iterativo para 3 Neuronas&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>En la gráfica anterior se observa una convergencia rápida hacia cero, se espera entonces un ajuste rápido del modelo
Ahora realizamos la predicción con el resto de los términos de la serie que son los datos seleccionados para test, pasamos pues una vez entrenada a probarla y a representarla gráficamente para ver el ajuste del modelo.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="redes-neuronales-recurrentes..html#cb124-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb124-2"><a href="redes-neuronales-recurrentes..html#cb124-2" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb124-3"><a href="redes-neuronales-recurrentes..html#cb124-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span>
<span id="cb124-4"><a href="redes-neuronales-recurrentes..html#cb124-4" tabindex="-1"></a><span class="fu">lines</span>(pred,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>El ajuste con los parámetros seleccionados, es decir size 3 que significa el número de neuronas en las capas ocultas de la red de Elman y número máximo de iteraciones que son 10000 demuestra una buena capacidad predictiva, ya que la curva del modelo y la de la predicción se muestran muy cercanas.</p>
<p>Esta visualización gráfica es útil para afinar tanto la predicción como el modelo mientras se prueban distintos parámetros de la red de Elman, asegurándose de que la curva del modelo y la de la predicción se ajusten lo mejor posible.</p>
<p>Ahora, con el efecto memoria, se avanza la serie temporal al menos un paso con una precisión excelente. Para lograrlo, reintroduciremos los datos de entrenamiento.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="redes-neuronales-recurrentes..html#cb125-1" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>train])</span>
<span id="cb125-2"><a href="redes-neuronales-recurrentes..html#cb125-2" tabindex="-1"></a>predictions</span></code></pre></div>
<pre><code>##                [,1]
## feb. 2024 0.5715654
## mar. 2024 0.5662302</code></pre>
<p>Posteriormente desnormalizamos los datos para mejorar la interpretación:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="redes-neuronales-recurrentes..html#cb127-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> predictions<span class="sc">*</span>(<span class="fu">max</span>(Z)<span class="sc">-</span><span class="fu">min</span>(Z))<span class="sc">+</span><span class="fu">min</span>(Z)</span>
<span id="cb127-2"><a href="redes-neuronales-recurrentes..html#cb127-2" tabindex="-1"></a>mod1</span></code></pre></div>
<pre><code>##               [,1]
## feb. 2024 15.19561
## mar. 2024 15.13782</code></pre>
<p>El modelo predice aproximadamente 15 casos nuevos en febrero y en marzo de 2024.</p>
<p>Ahora veamos la representación de los valores predichos para el siguiente periodo:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="redes-neuronales-recurrentes..html#cb129-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(tamano_total<span class="sc">+</span><span class="fu">length</span>(mod1))</span>
<span id="cb129-2"><a href="redes-neuronales-recurrentes..html#cb129-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(Z),mod1)</span>
<span id="cb129-3"><a href="redes-neuronales-recurrentes..html#cb129-3" tabindex="-1"></a><span class="fu">plot</span>(x[<span class="dv">1</span><span class="sc">:</span>tamano_total], y[<span class="dv">1</span><span class="sc">:</span>tamano_total],<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb129-4"><a href="redes-neuronales-recurrentes..html#cb129-4" tabindex="-1"></a><span class="fu">lines</span>( x[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], y[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="redes-neuronales-recurrentes..html#cb130-1" tabindex="-1"></a><span class="fu">length</span>(y)</span></code></pre></div>
<pre><code>## [1] 53</code></pre>
</div>
<div id="modelo-de-jordan." class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Modelo de Jordan.<a href="redes-neuronales-recurrentes..html#modelo-de-jordan." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El modelo de Jordan es otra variante de las redes neuronales recurrentes (RNN), desarrollado por Michael I. Jordan en 1986. Al igual que el modelo de Elman, el modelo de Jordan introduce una capa adicional que permite a la red capturar dependencias temporales en secuencias de datos. Sin embargo, hay algunas diferencias clave en la forma en que ambos modelos manejan la información de estado anterior.</p>
<p>La red de Elman tiende a ser más adecuada para tareas donde es crucial capturar dependencias temporales intermedias y dinámicas complejas entre las entradas y las salidas ocultas. La red de Jordan: Es más adecuada para tareas donde la salida anterior directa puede ser un predictor importante del siguiente estado, como en el modelado de secuencias de decisiones.</p>
<p><strong>Arquitectura de la Red Neuronal de Jordan:</strong></p>
<p>La red neuronal de Jordan consta de las siguientes componentes:</p>
<ul>
<li><p><strong>Capa de Entrada:</strong> Recibe los datos de entrada.</p></li>
<li><p><strong>Capa Oculta:</strong> Procesa los datos de entrada y también recibe la salida de la capa de contexto.</p></li>
<li><p><strong>Capa de Salida:</strong> Produce la predicción o salida final.</p></li>
<li><p><strong>Capa de Contexto:</strong> Almacena una copia de la salida de la capa de salida en el tiempo t-1 y la alimenta de nuevo a la capa oculta en el tiempo t.</p></li>
</ul>
<p><strong>Ejecución del modelo:</strong></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="redes-neuronales-recurrentes..html#cb132-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co">#Se fija la semilla</span></span>
<span id="cb132-2"><a href="redes-neuronales-recurrentes..html#cb132-2" tabindex="-1"></a></span>
<span id="cb132-3"><a href="redes-neuronales-recurrentes..html#cb132-3" tabindex="-1"></a><span class="co">#teniendo los datos previamente separados, se ajustan los datos de entremaniento entrenando la red de Jordan:</span></span>
<span id="cb132-4"><a href="redes-neuronales-recurrentes..html#cb132-4" tabindex="-1"></a></span>
<span id="cb132-5"><a href="redes-neuronales-recurrentes..html#cb132-5" tabindex="-1"></a>fit <span class="ot">&lt;-</span><span class="fu">jordan</span>(inputs[train],outputs[train],<span class="at">size=</span><span class="dv">5</span>,<span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb132-6"><a href="redes-neuronales-recurrentes..html#cb132-6" tabindex="-1"></a>             <span class="at">maxit=</span><span class="dv">35000</span>)</span>
<span id="cb132-7"><a href="redes-neuronales-recurrentes..html#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="redes-neuronales-recurrentes..html#cb132-8" tabindex="-1"></a><span class="co">#Y graficamos el error iterativo:</span></span>
<span id="cb132-9"><a href="redes-neuronales-recurrentes..html#cb132-9" tabindex="-1"></a></span>
<span id="cb132-10"><a href="redes-neuronales-recurrentes..html#cb132-10" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit, <span class="at">main =</span> <span class="st">&quot;Error Iterativo para 5 neuronas&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>De nuevo se observa cómo el error tiende a cero rápidamente.</p>
<p>A continuación se realiza una comparación visual entre las salidas reales y las predicciones del modelo:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="redes-neuronales-recurrentes..html#cb133-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb133-2"><a href="redes-neuronales-recurrentes..html#cb133-2" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb133-3"><a href="redes-neuronales-recurrentes..html#cb133-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span>
<span id="cb133-4"><a href="redes-neuronales-recurrentes..html#cb133-4" tabindex="-1"></a><span class="fu">lines</span>(pred,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>A diferencia del modelo de Elman, con el modelo de Jordan hay mayor diferencia entre los valores observados y los predichos por el modelo, los tres últimos periodos son los más parecidos.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="redes-neuronales-recurrentes..html#cb134-1" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit,inputs[<span class="sc">-</span>train])</span>
<span id="cb134-2"><a href="redes-neuronales-recurrentes..html#cb134-2" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> predictions<span class="sc">*</span>(<span class="fu">max</span>(Z)<span class="sc">-</span><span class="fu">min</span>(Z))<span class="sc">+</span><span class="fu">min</span>(Z)</span>
<span id="cb134-3"><a href="redes-neuronales-recurrentes..html#cb134-3" tabindex="-1"></a>mod2</span></code></pre></div>
<pre><code>##               [,1]
## feb. 2024 14.97098
## mar. 2024 15.63828</code></pre>
<p>Con el modelo de Jordan se predicen aproximadamente 15 casos en febrero y cerca de 16 en marzo.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="redes-neuronales-recurrentes..html#cb136-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(tamano_total<span class="sc">+</span><span class="fu">length</span>(mod2))</span>
<span id="cb136-2"><a href="redes-neuronales-recurrentes..html#cb136-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.vector</span>(Z),mod2)</span>
<span id="cb136-3"><a href="redes-neuronales-recurrentes..html#cb136-3" tabindex="-1"></a><span class="fu">plot</span>(x[<span class="dv">1</span><span class="sc">:</span>tamano_total], y[<span class="dv">1</span><span class="sc">:</span>tamano_total],<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb136-4"><a href="redes-neuronales-recurrentes..html#cb136-4" tabindex="-1"></a><span class="fu">lines</span>( x[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], y[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="SeriesTiempoCOVID_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>En la gráfica de predicción, similar al modelo de Elman, en el modelo de Jordan se presenta un incremento en los casos para el siguiente periodo.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelización.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
